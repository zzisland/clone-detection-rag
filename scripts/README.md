# 论文处理工具

本工具用于处理PDF论文，自动提取信息并生成问答对。

## 🛠️ 工具概览

### PDF处理工具 (`pdf_processor.py`)
- **功能**: 从PDF提取论文信息、生成问答对
- **输入**: PDF文件目录
- **输出**: 论文元数据、问答对、文本文件
- **特点**: 智能文本提取、自动信息识别、支持自定义路径

### 数据集管理工具 (`dataset_manager.py`)
- **功能**: 验证、分析、统计数据集
- **输出**: 数据质量报告、统计信息
- **特点**: 完整的数据集健康检查

## 📋 使用方法

### 第一步：处理PDF论文

#### 默认使用（处理CloneDetection paper目录）
```bash
cd scripts
python pdf_processor.py
```

#### 自定义路径
```bash
cd scripts
python pdf_processor.py --source /path/to/pdfs --output /path/to/output
```

#### 命令行参数
- `--source`: PDF文件目录（默认: CloneDetection paper）
- `--output`: 输出目录（默认: data/google_scholar_papers）

**处理流程**:
1. 自动读取指定目录下的PDF文件
2. 提取论文标题、作者、摘要、年份、会议等信息
3. 生成10种类型的问答对（概念、比较、应用、评估、技术、挑战、优化、集成、趋势、技术术语）
4. 保存到指定输出目录

**预期输出**:
```
=== PDF论文处理工具 ===
源目录: ../CloneDetection paper
输出目录: ../data/google_scholar_papers

找到 30 个PDF文件
正在处理: 1368088.1368172.pdf
✅ 成功处理: Code Clone Detection: A Comprehensive Survey
...
成功处理 25/30 个PDF文件
生成了 5000+ 个问答对
数据已保存到: ../data/google_scholar_papers
- 论文数量: 25
- 问答对数量: 5000+

=== 处理完成 ===
有效论文: 25 篇
问答对: 5000+ 个
数据保存位置: ../data/google_scholar_papers

=== 统计信息 ===
年份范围: 2018 - 2023
主要会议: ICSE
平均作者数: 3.2
```

### 第二步：验证数据质量

```bash
python dataset_manager.py
```

**预期输出**:
```
=== 数据集分析结果 ===
总文档数: 156
预估分块数: 89
问答对数量: 180
健康评分: 95.2

详细报告已保存到 data/analysis/ 目录
```

### 第三步：重新摄取数据

```bash
cd ..
python run.py
```

或者在Streamlit界面中点击"重新摄取数据"按钮。

## 📊 数据结构

### 输入结构
```
F:\clone-detection-rag\CloneDetection paper\
├── 1368088.1368172.pdf
├── 1810295.1810308.pdf
├── A Survey on Software Clone Detection Research∗.pdf
└── ... (30个PDF文件)
```

### 输出结构
```
F:\clone-detection-rag\data\google_scholar_papers\
├── papers.json          # 论文元数据
├── qa_pairs.json        # 问答对
└── texts/               # 论文文本文件
    ├── paper_001.txt
    ├── paper_002.txt
    └── ...
```

## 🔧 智能功能

### PDF信息提取
- **标题**: 自动识别论文标题
- **作者**: 提取作者列表
- **摘要**: 智能提取Abstract部分
- **年份**: 从文本和文件名提取
- **会议**: 识别会议/期刊信息
- **关键词**: 提取Keywords部分

### 问答对生成
1. **概念问答**: 解释基本概念和定义
2. **比较问答**: 对比不同方法的优缺点
3. **应用问答**: 实际使用指导和注意事项
4. **评估问答**: 效果评估和性能指标
5. **技术问答**: 技术原理和实现方法

### 数据验证
- **标题长度**: 至少10个字符
- **摘要长度**: 至少100个字符
- **年份范围**: 1990-2026
- **相关性**: 至少包含2个相关关键词

## 📈 预期效果

### 数据规模
| 指标 | 预期数量 | 说明 |
|------|----------|------|
| 论文数量 | 20-25篇 | 通过验证的有效论文 |
| 问答对数量 | 5000+个 | 10种类型自动生成 |
| 文档块数量 | 5000+个 | 用于向量化 |
| 向量数量 | 5000+个 | 支持RAG检索 |

### 问答对分布
| 类型 | 模板数量 | 预期数量 | 示例 |
|------|----------|----------|------|
| 概念问答 | 20个 | 400-600个 | "什么是代码克隆检测？" |
| 比较问答 | 20个 | 200-400个 | "CCFinder和NiCad有什么区别？" |
| 应用问答 | 20个 | 400-600个 | "如何应用AST-based方法？" |
| 评估问答 | 20个 | 200-400个 | "如何评估检测效果？" |
| 技术问答 | 20个 | 400-600个 | "CCFinder的技术原理是什么？" |
| 挑战问答 | 10个 | 200-300个 | "方法面临的主要挑战？" |
| 优化问答 | 10个 | 200-300个 | "如何优化方法性能？" |
| 集成问答 | 10个 | 200-300个 | "如何集成到开发流程？" |
| 趋势问答 | 10个 | 200-300个 | "方法的发展趋势？" |
| 技术术语问答 | 5个 | 500-800个 | "什么是算法？" |
| 论文特定问答 | 10个 | 200-250个 | "论文的主要贡献？" |

## 🚨 注意事项

### PDF质量要求
- **文本可提取**: PDF包含可选择的文本（非扫描版）
- **结构清晰**: 包含Abstract、Introduction等标准部分
- **语言**: 英文论文（工具针对英文优化）
- **相关性**: 与代码克隆检测相关

### 处理时间
- **PDF解析**: 每个PDF 2-5秒
- **信息提取**: 每个PDF 1-2秒
- **问答生成**: 每篇论文 10-20秒（生成大量问答对）
- **总处理时间**: 约15-30分钟

### 常见问题

#### 1. PDF文本提取失败
```
❌ PDF文本内容过短: filename.pdf
```
**解决方案**: 确保PDF是文本格式而非扫描图片

#### 2. 论文验证失败
```
❌ 论文验证失败: filename.pdf
```
**解决方案**: 检查论文是否与代码克隆检测相关

#### 3. 摘要提取失败
```
Abstract not found in PDF
```
**解决方案**: 部分论文格式特殊，会自动跳过

## 🔍 故障排除

### 调试模式
启用详细日志：
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### 手动检查
处理完成后，可以检查：
- `data/google_scholar_papers/papers.json` - 论文信息
- `data/google_scholar_papers/qa_pairs.json` - 问答对
- `data/google_scholar_papers/texts/` - 文本文件

## 📞 支持

如遇到问题：
1. 检查PDF文件是否为文本格式
2. 确认论文内容相关性
3. 查看处理日志信息
4. 检查输出目录权限

---

**更新日期**: 2026年1月11日
**版本**: v1.0 (PDF处理版)
